# Tablet API (ALT - Anoto Live tablet)

If working on this project, please bear in mind that it needs to work
with **BOTH** Formidable 2.13 _AND_ Live forms releases. This will remain
the case until all customers can be suitably migrated to the ALF platform.

Things that the API needs to do

1. Login/Authentication - **COMPLETE**
  * Basic HTTP authentication, already provided and not managed by API

2. List of form templates/models - **COMPLETE**
  * Name, Description, ID, Created Date, Modified Date

3. Download of form template with background image - **COMPLETE**
  * Config XML and background PNG's (base 64 encoded files - PNG's are cached for speed)

4. List of submissions by form
  * Ideally we can grab a paged list of 20-50 submissions at a time. 
  * Each item in list would contain: formIdentifier, Last Editor, Last Edit Date, Form State (Valid/Invalid, mandatory fields etc), form reference/key fields (if available)

5. Get form data by formIdentifier
  * For integration into the form layout. 
  * Retrieval of the strokes on a page by page basis, either by themselves or rendered onto the background would allow pen data display within the tablet editor.

6. Update form data by formIdentifier.
  * To update text fields, radio/check boxes, ideally by sending a single xml document to the server. 
  * An additional call to update drawing/signature fields would be a good feature.

7. Begin a new form.
  * To create and assign pattern to a form with new data. 
  * This would need to be a synchronous call to return the new formIdentifier. 
  * For the ALE implementation we were able to use the pre-population API of the platform.

8. Get last modified date by formUnique (or by array of formUniques)
  * To allow tablet app to poll for changes to cached forms.
    - Better as a sub-function of point 5
	
	
	
# Using the API

## 1. Listing the applications

URL endpoint: https://servername/alt/route/fetchapps

This will return an XML document with the following elements
```xml
<?xml version="1.0"?>
<tablet>
	<organisation id="1" name="org name"> <!-- may appear multiple times, depending on user access rights -->
		<app> <!-- appears multiple times depending on number of apps in organisation -->
			<id>12</id>
			<name>App name</name>
			<pages>2</pages>
			<description>a description of the app</description>
			<created>2014-01-02 12:30:32</created>
			<modified>2014-05-28 13:32:04</modified>
			<version>2</version>
		</app>
	</organisation>
</tablet>
```

**Errors**
No errors should be generated by this call

## 2. Download form template with backgrounds

URL endpoint: https://servername/alt/route/fetchapp/id/<appId> where <appId> comes from tablet->organisation->app->id in the above request.

This will return an XML document with the following elements
```xml
<?xml version="1.0"?>
<tablet>
	<application>
		<config>base64 encoded config.xml file</config>
		<pages>
			<page id="1">base64 encoded PNG of page, currently set at 150dpi</page>
			<page id="2">base64 encoded PNG of page, currently set at 150dpi</page>
		</pages>
</tablet>
``` 

**Errors**
This call could return one of the following errors. Only one error will appear at a time.

```xml
<?xml version="1.0"?>
<tablet>
	<error>ID not given</error> <!-- An ID value was not sent as part of the URL -->
	<error>ID value is not a number</error> <!-- The ID value is not a valid integer -->
	<error>No such application in registry ('appId')</error><!-- The application does not exist, it may have been deleted -->
</tablet>
```